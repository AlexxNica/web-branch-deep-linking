---
dependencies:
  post:
    # Closure COmpiler
    - mkdir -p compiler
    - wget http://dl.google.com/closure-compiler/compiler-latest.zip
    - unzip compiler-latest.zip -d compiler
    # Closrue compiler library
    - mkdir -p compiler/library
    - wget https://github.com/google/closure-library/archive/master.zip
    - unzip master.zip -d compiler/library
    # Sauceyness
    - wget https://saucelabs.com/downloads/sc-latest-linux.tar.gz
    - tar -xzf sc-latest-linux.tar.gz
    - npm install -g karma-cli
    - npm install

test:
  override:
    - ./bin/sc -u $SAUCE_USERNAME -k $SAUCE_ACCESS_KEY -f ~/sc_ready:
        background: true
        pwd: sc-*-linux
    # Wait for tunnel to be ready
    - while [ ! -e ~/sc_ready ]; do sleep 1; done
    - karma start